import React from 'react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Label } from '@/components/ui/label';
import { Input } from '@/components/ui/input';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Checkbox } from '@/components/ui/checkbox';
import { PasswordConfirmation } from '@/components/ui/password-confirmation';
import { Button } from '@/components/ui/button';
import { CommunicationAdapter } from '@/types/adapter';

interface JmsSenderAdapterConfigurationProps {
  adapter: CommunicationAdapter;
  onUpdate: (adapter: CommunicationAdapter) => void;
}

export function JmsSenderAdapterConfiguration({
  adapter,
  onUpdate
}: JmsSenderAdapterConfigurationProps) {
  const handleInputChange = (field: string, value: string | number | boolean) => {
    onUpdate({
      ...adapter,
      configuration: {
        ...adapter.configuration,
        [field]: value
      }
    });
  };

  const handleTestConnection = () => {
    // TODO: Implement test connection functionality
    alert('Testing connection... (not implemented)');
  };

  return (
    <div className="space-y-6">
      <Tabs defaultValue="source" className="w-full">
        <TabsList className="grid w-full grid-cols-1">
          <TabsTrigger value="source">Source</TabsTrigger>
        </TabsList>

        <TabsContent value="source" className="space-y-6">
          <Card>
            <CardHeader>
              <CardTitle>Connection Details</CardTitle>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="queueManager">Queue Manager Name *</Label>
                  <Input
                    id="queueManager"
                    placeholder="QM1"
                    value={adapter.configuration.queueManager || ''}
                    onChange={(e) => handleInputChange('queueManager', e.target.value)}
                    required
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="host">Host Name / IP *</Label>
                  <Input
                    id="host"
                    placeholder="mqserver.example.com"
                    value={adapter.configuration.host || ''}
                    onChange={(e) => handleInputChange('host', e.target.value)}
                    required
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="port">Port *</Label>
                  <Input
                    id="port"
                    type="number"
                    placeholder="1414"
                    value={adapter.configuration.port || ''}
                    onChange={(e) => handleInputChange('port', parseInt(e.target.value))}
                    required
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="channel">Channel Name *</Label>
                  <Input
                    id="channel"
                    placeholder="CHANNEL.SVRCONN"
                    value={adapter.configuration.channel || ''}
                    onChange={(e) => handleInputChange('channel', e.target.value)}
                    required
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="connectionFactory">Connection Factory JNDI Name</Label>
                  <Input
                    id="connectionFactory"
                    placeholder="jms/ConnectionFactory"
                    value={adapter.configuration.connectionFactory || ''}
                    onChange={(e) => handleInputChange('connectionFactory', e.target.value)}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="queueName">Queue Name *</Label>
                  <Input
                    id="queueName"
                    placeholder="INBOUND.FILE.QUEUE"
                    value={adapter.configuration.queueName || ''}
                    onChange={(e) => handleInputChange('queueName', e.target.value)}
                    required
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="transportType">Transport Type *</Label>
                  <Select
                    value={adapter.configuration.transportType || ''}
                    onValueChange={(value) => handleInputChange('transportType', value)}
                  >
                    <SelectTrigger>
                      <SelectValue placeholder="Select transport type" />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="CLIENT">CLIENT</SelectItem>
                      <SelectItem value="BINDINGS">BINDINGS</SelectItem>
                    </SelectContent>
                  </Select>
                </div>

                <div className="space-y-2">
                  <Label htmlFor="username">User Name</Label>
                  <Input
                    id="username"
                    placeholder="MQ Username"
                    value={adapter.configuration.username || ''}
                    onChange={(e) => handleInputChange('username', e.target.value)}
                  />
                </div>

                <div className="space-y-2">
                  <PasswordConfirmation
                    name="password"
                    label="Password"
                    placeholder="MQ Password"
                    required={false}
                    value={adapter.configuration.password || ''}
                    onValueChange={(value) => handleInputChange('password', value)}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="destinationType">JMS Destination Type *</Label>
                  <Select
                    value={adapter.configuration.destinationType || ''}
                    onValueChange={(value) => handleInputChange('destinationType', value)}
                  >
                    <SelectTrigger>
                      <SelectValue placeholder="Select destination type" />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="Queue">Queue</SelectItem>
                      <SelectItem value="Topic">Topic</SelectItem>
                    </SelectContent>
                  </Select>
                </div>

                <div className="space-y-2">
                  <Label htmlFor="messageSelector">Message Selector</Label>
                  <Input
                    id="messageSelector"
                    placeholder="JMSType='FileMessage'"
                    value={adapter.configuration.messageSelector || ''}
                    onChange={(e) => handleInputChange('messageSelector', e.target.value)}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="clientId">Client ID</Label>
                  <Input
                    id="clientId"
                    placeholder="Optional Client ID"
                    value={adapter.configuration.clientId || ''}
                    onChange={(e) => handleInputChange('clientId', e.target.value)}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="ackMode">Acknowledgement Mode *</Label>
                  <Select
                    value={adapter.configuration.ackMode || ''}
                    onValueChange={(value) => handleInputChange('ackMode', value)}
                  >
                    <SelectTrigger>
                      <SelectValue placeholder="Select acknowledgement mode" />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="AUTO_ACKNOWLEDGE">AUTO_ACKNOWLEDGE</SelectItem>
                      <SelectItem value="CLIENT_ACKNOWLEDGE">CLIENT_ACKNOWLEDGE</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              </div>

              <div className="flex items-center space-x-2">
                <Checkbox
                  id="useSSL"
                  checked={adapter.configuration.useSSL || false}
                  onCheckedChange={(checked) => handleInputChange('useSSL', checked)}
                />
                <Label htmlFor="useSSL">Use SSL/TLS</Label>
              </div>

              {adapter.configuration.useSSL && (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div className="space-y-2">
                    <Label htmlFor="sslKeystore">SSL Keystore Path</Label>
                    <Input
                      id="sslKeystore"
                      placeholder="/path/to/keystore"
                      value={adapter.configuration.sslKeystore || ''}
                      onChange={(e) => handleInputChange('sslKeystore', e.target.value)}
                    />
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="sslPassword">SSL Keystore Password</Label>
                    <Input
                      id="sslPassword"
                      type="password"
                      placeholder="Keystore Password"
                      value={adapter.configuration.sslPassword || ''}
                      onChange={(e) => handleInputChange('sslPassword', e.target.value)}
                    />
                  </div>
                </div>
              )}

              <div className="flex gap-4 pt-4">
                <Button type="button" variant="outline" onClick={handleTestConnection}>
                  Test Connection
                </Button>
                <Button type="submit">
                  Save Configuration
                </Button>
              </div>
            </CardContent>
          </Card>
        </TabsContent>
      </Tabs>
    </div>
  );
}